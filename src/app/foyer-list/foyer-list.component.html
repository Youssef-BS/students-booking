<!-- Magic Styles -->
<style>
  .glass-card {
    background: rgba(255, 255, 255, 0.75);
    border-radius: 1rem;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
    backdrop-filter: blur(7px);
    -webkit-backdrop-filter: blur(7px);
    border: 1px solid rgba(255, 255, 255, 0.18);
  }

  .fancy-title {
    font-family: "Poppins", sans-serif;
    font-size: 3rem;
    font-weight: 700;
    color: #0d6efd;
    background: linear-gradient(90deg, #0d6efd, #6610f2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .action-btn {
    transition: all 0.3s ease-in-out;
  }

  .action-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0.5rem 1rem rgba(13, 110, 253, 0.2);
  }

  /* Dark Theme Styles */
  .dark-theme {
    background-color: #121212;
    color: #e0e0e0;
  }

  .dark-theme .glass-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(8px);
    color: #e0e0e0;
  }

  .dark-theme .table {
    color: #e0e0e0;
  }

  .dark-theme .btn,
  .dark-theme .form-control,
  .dark-theme .input-group-text {
    background-color: #1e1e1e;
    color: #e0e0e0;
    border-color: #333;
  }

  .dark-theme .form-check-label {
    color: #e0e0e0;
  }
</style>

<!-- Root Wrapper for Theme -->
<div [ngClass]="{ 'dark-theme': isDarkMode }">
  <!-- Modern UI Container -->
  <div class="container py-5">
    <!-- Title + Dark Mode Toggle -->
    <div class="text-center mb-3">
      <h1 class="fancy-title">🏠 Gestion des Foyers</h1>

      <div
        class="form-check form-switch d-flex justify-content-center align-items-center mt-3"
      >
        <input
          class="form-check-input"
          type="checkbox"
          id="darkModeToggle"
          [(ngModel)]="isDarkMode"
          (change)="toggleDarkMode()"
        />
        <label class="form-check-label ms-2" for="darkModeToggle"
          >🌙 Mode Sombre</label
        >
      </div>
    </div>

    <!-- Header Actions -->
    <div
      class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3"
    >
      <!-- Search Bar -->
      <div class="input-group w-50 shadow-sm rounded">
        <span class="input-group-text bg-white border-end-0">🔍</span>
        <input
          type="text"
          class="form-control border-start-0"
          placeholder="Rechercher un foyer..."
          [(ngModel)]="searchTerm"
          (input)="filterFoyers()"
        />
      </div>

      <!-- Add Button -->
      <button
        class="btn btn-gradient-primary action-btn px-4"
        (click)="showAddFoyerForm = !showAddFoyerForm"
      >
        ➕ Nouveau Foyer
      </button>
    </div>

    <!-- Add Foyer Form -->
    <div *ngIf="showAddFoyerForm" class="glass-card p-4 mb-5">
      <h4 class="text-center text-success mb-4">🏗️ Ajouter un Foyer</h4>
      <form (ngSubmit)="addFoyer()">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Nom du Foyer</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="newFoyer.nomFoyer"
              name="nomFoyer"
              required
            />
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Capacité</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="newFoyer.capaciteFoyer"
              name="capaciteFoyer"
              required
            />
          </div>
        </div>
        <div class="text-end mt-4">
          <button class="btn btn-success me-2 action-btn">
            💾 Enregistrer
          </button>
          <button
            type="button"
            class="btn btn-outline-secondary action-btn"
            (click)="cancelAdd()"
          >
            ❌ Annuler
          </button>
        </div>
      </form>
    </div>

    <!-- Foyer Table -->
    <div class="glass-card overflow-hidden">
      <table class="table align-middle mb-0">
        <thead
          class="text-white"
          style="background: linear-gradient(90deg, #0d6efd, #6610f2)"
        >
          <tr>
            <th>#</th>
            <th>Nom</th>
            <th>Capacité</th>
            <th>Statut</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let foyer of filteredFoyers; let i = index"
            [ngStyle]="{ backgroundColor: i % 2 === 0 ? '#f8f9fa' : '#ffffff' }"
          >
            <td class="fw-bold">{{ i + 1 }}</td>
            <td>{{ foyer.nomFoyer }}</td>
            <td>{{ foyer.capaciteFoyer }}</td>
            <td>
              <span
                class="badge px-3 py-2"
                [ngClass]="
                  foyer.capaciteFoyer > 100
                    ? 'bg-success'
                    : 'bg-warning text-dark'
                "
              >
                {{
                  foyer.capaciteFoyer > 100
                    ? "Grande capacité"
                    : "Capacité normale"
                }}
              </span>
            </td>
            <td class="text-center">
              <button
                class="btn btn-outline-primary btn-sm me-2 action-btn"
                (click)="editFoyer(foyer)"
              >
                ✏️ Modifier
              </button>
              <button
                class="btn btn-outline-danger btn-sm action-btn"
                (click)="deleteFoyer(foyer.idFoyer)"
              >
                🗑️ Supprimer
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Edit Foyer Form -->
    <div *ngIf="selectedFoyer" class="glass-card p-4 mt-5">
      <h4 class="text-primary text-center mb-4">✏️ Modifier le Foyer</h4>
      <form (ngSubmit)="updateFoyer()">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Nom du Foyer</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="selectedFoyer.nomFoyer"
              name="nomFoyer"
              required
            />
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Capacité</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="selectedFoyer.capaciteFoyer"
              name="capaciteFoyer"
              required
            />
          </div>
        </div>
        <div class="text-end mt-4">
          <button class="btn btn-success me-2 action-btn">
            💾 Sauvegarder
          </button>
          <button
            type="button"
            class="btn btn-outline-secondary action-btn"
            (click)="cancelEdit()"
          >
            ❌ Annuler
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
